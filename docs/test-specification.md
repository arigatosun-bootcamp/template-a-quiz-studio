# JapanMaster テスト仕様書

> 本文書は、JapanMaster（日本制覇への道）の全機能に対するテストケースを定義する。
> 要件定義書（requirements.md）および機能要件書（functional-requirements.md）に基づいて作成。

---

## テストケース集計表

| カテゴリ | 正常系 | 異常系 | 境界値 | 認証ガード | レスポンシブ | 合計 |
|----------|--------|--------|--------|------------|--------------|------|
| ログイン画面 | 4 | 6 | 0 | 2 | 2 | 14 |
| 新規登録画面 | 4 | 7 | 2 | 2 | 2 | 17 |
| パスワードリセット画面 | 3 | 3 | 0 | 1 | 1 | 8 |
| トップ画面 | 6 | 3 | 1 | 1 | 2 | 13 |
| クイズ画面 | 8 | 5 | 1 | 2 | 2 | 18 |
| 結果画面 | 5 | 1 | 2 | 2 | 1 | 11 |
| 回答履歴画面 | 4 | 1 | 1 | 1 | 2 | 9 |
| 達成状況画面 | 5 | 0 | 1 | 1 | 2 | 9 |
| 設定画面 | 4 | 5 | 2 | 1 | 1 | 13 |
| 共通機能（ヘッダー・ナビ・ログアウト） | 6 | 0 | 0 | 1 | 3 | 10 |
| エラー画面・ローディング | 5 | 0 | 0 | 0 | 0 | 5 |
| **合計** | **54** | **31** | **10** | **14** | **18** | **127** |

---

## 1. ログイン画面（/login）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-001 | ログイン画面 | メール&パスワードでログインできる | メール認証済みのアカウントが存在する | 1. /login にアクセス<br>2. メールアドレスを入力<br>3. パスワードを入力<br>4. 「ログイン」ボタンをクリック | トップ画面（/）にリダイレクトされる | 高 |
| TC-002 | ログイン画面 | Googleアカウントでログインできる | Googleアカウントを持っている | 1. /login にアクセス<br>2. 「Googleでログイン」ボタンをクリック<br>3. Googleの認証画面で認証する | Google認証後、トップ画面（/）にリダイレクトされる | 高 |
| TC-003 | ログイン画面 | パスワードの表示/非表示を切り替えられる | /login にアクセスしている | 1. パスワード入力欄にパスワードを入力<br>2. 目のアイコンをクリック | パスワードが平文で表示される。再度クリックするとマスクされる | 中 |
| TC-004 | ログイン画面 | 各リンクから正しい画面に遷移できる | /login にアクセスしている | 1. 「パスワードを忘れた方はこちら」をクリック<br>2. 戻って「新規登録はこちら」をクリック | 1. /reset-password に遷移する<br>2. /register に遷移する | 中 |

### 異常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-005 | ログイン画面 | メールアドレス未入力時にエラーが表示される | /login にアクセスしている | 1. メールアドレスを空のまま<br>2. パスワードを入力<br>3. 「ログイン」ボタンをクリック | 「メールアドレスを入力してください」が赤字で表示される | 高 |
| TC-006 | ログイン画面 | 不正なメール形式でエラーが表示される | /login にアクセスしている | 1. メールアドレス欄に「abc」と入力<br>2. パスワードを入力<br>3. 「ログイン」ボタンをクリック | 「正しいメールアドレスを入力してください」が赤字で表示される | 高 |
| TC-007 | ログイン画面 | パスワード未入力時にエラーが表示される | /login にアクセスしている | 1. メールアドレスを入力<br>2. パスワードを空のまま<br>3. 「ログイン」ボタンをクリック | 「パスワードを入力してください」が赤字で表示される | 高 |
| TC-008 | ログイン画面 | 誤ったメールまたはパスワードでエラーが表示される | /login にアクセスしている | 1. 存在しないメールアドレスを入力<br>2. 適当なパスワードを入力<br>3. 「ログイン」ボタンをクリック | 「メールアドレスまたはパスワードが正しくありません」が表示される | 高 |
| TC-009 | ログイン画面 | メール未確認アカウントでエラーが表示される | 新規登録済みだがメール確認が完了していないアカウント | 1. 未確認メールアドレスでログインを試みる | 「メール認証が完了していません。確認メールをご確認ください」が表示される | 高 |
| TC-010 | ログイン画面 | 5回連続ログイン失敗でアカウントがロックされる | 有効なアカウントが存在する | 1. 正しいメールアドレスを入力<br>2. 誤ったパスワードで5回連続ログインを試みる | 「ログイン試行回数を超えました。しばらく経ってからお試しください」が表示される。30分間ログイン不可 | 高 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-011 | ログイン画面 | ログイン済みユーザーはトップにリダイレクトされる | ログイン済みの状態 | 1. ブラウザで /login にアクセス | トップ画面（/）にリダイレクトされる | 高 |
| TC-012 | ログイン画面 | ログインボタンが二重送信を防止する | /login にアクセスしている | 1. 正しい情報を入力<br>2. 「ログイン」ボタンを素早く2回クリック | ボタンがローディング状態になり、2回目のクリックが無視される | 中 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-013 | ログイン画面 | PC画面（768px以上）で正しくレイアウトされる | PCブラウザ（幅768px以上） | 1. /login にアクセス | 和風背景 + 白い枠のフォームが中央に表示される。ヘッダーは非表示 | 中 |
| TC-014 | ログイン画面 | スマホ画面（767px以下）で正しくレイアウトされる | モバイルブラウザ（幅767px以下） | 1. /login にアクセス | フォームが画面幅に収まり、ボタンがタップしやすいサイズで表示される | 中 |

---

## 2. 新規登録画面（/register）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-015 | 新規登録画面 | メール&パスワードで新規登録できる | 未登録のメールアドレスを使用 | 1. /register にアクセス<br>2. メールアドレスを入力<br>3. パスワード（8文字以上）を入力<br>4. パスワード確認を入力<br>5. 利用規約に同意チェック<br>6. 「新規登録」ボタンをクリック | 「確認メールを送信しました。メール内のリンクをクリックしてください」が表示される | 高 |
| TC-016 | 新規登録画面 | メール確認リンクのクリック後にログイン画面に遷移する | TC-015 で登録が完了している | 1. 確認メールを開く<br>2. メール内のリンクをクリック | /login に遷移し、「認証が完了しました。ログインしてください」が表示される | 高 |
| TC-017 | 新規登録画面 | Googleで新規登録できる | Googleアカウントを持っている | 1. /register にアクセス<br>2. 「Googleで登録」ボタンをクリック<br>3. Googleの認証画面で認証する | Google認証後、トップ画面（/）にリダイレクトされる | 高 |
| TC-018 | 新規登録画面 | 各リンクから正しい画面に遷移できる | /register にアクセスしている | 1. 「ログインはこちら」リンクをクリック | /login に遷移する | 中 |

### 異常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-019 | 新規登録画面 | メールアドレス未入力時にエラーが表示される | /register にアクセスしている | 1. メールアドレスを空のまま<br>2. 他の項目を正しく入力<br>3. 「新規登録」ボタンをクリック | 「メールアドレスを入力してください」が赤字で表示される | 高 |
| TC-020 | 新規登録画面 | 不正なメール形式でエラーが表示される | /register にアクセスしている | 1. メールアドレス欄に「abc」と入力<br>2. 他の項目を正しく入力<br>3. 「新規登録」ボタンをクリック | 「正しいメールアドレスを入力してください」が赤字で表示される | 高 |
| TC-021 | 新規登録画面 | パスワード未入力時にエラーが表示される | /register にアクセスしている | 1. パスワードを空のまま<br>2. 他の項目を正しく入力<br>3. 「新規登録」ボタンをクリック | 「パスワードを入力してください」が赤字で表示される | 高 |
| TC-022 | 新規登録画面 | パスワードが8文字未満でエラーが表示される | /register にアクセスしている | 1. パスワード欄に「abc1234」（7文字）を入力<br>2. 他の項目を正しく入力<br>3. 「新規登録」ボタンをクリック | 「パスワードは8文字以上で入力してください」が赤字で表示される | 高 |
| TC-023 | 新規登録画面 | パスワードと確認が不一致でエラーが表示される | /register にアクセスしている | 1. パスワード欄に「password1」を入力<br>2. パスワード確認欄に「password2」を入力<br>3. 「新規登録」ボタンをクリック | 「パスワードが一致しません」が赤字で表示される | 高 |
| TC-024 | 新規登録画面 | 利用規約未同意でエラーが表示される | /register にアクセスしている | 1. 全項目を正しく入力<br>2. 利用規約チェックボックスを未チェックのまま<br>3. 「新規登録」ボタンをクリック | 「利用規約・プライバシーポリシーに同意してください」が表示される | 高 |
| TC-025 | 新規登録画面 | 既に登録済みのメールアドレスでエラーが表示される | 登録済みのメールアドレスが存在する | 1. 登録済みメールアドレスを入力<br>2. 他の項目を正しく入力<br>3. 「新規登録」ボタンをクリック | 「このメールアドレスは既に登録されています」が表示される | 高 |

### 境界値

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-026 | 新規登録画面 | パスワード8文字ちょうどで登録できる | /register にアクセスしている | 1. パスワード欄に「abcd1234」（8文字）を入力<br>2. 確認欄にも同じ値を入力<br>3. 他の項目を正しく入力して登録 | パスワードバリデーションを通過し、登録処理が実行される | 高 |
| TC-027 | 新規登録画面 | パスワード7文字で登録できない | /register にアクセスしている | 1. パスワード欄に「abcd123」（7文字）を入力<br>2. 確認欄にも同じ値を入力<br>3. 他の項目を正しく入力して登録 | 「パスワードは8文字以上で入力してください」が赤字で表示される | 高 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-028 | 新規登録画面 | ログイン済みユーザーはトップにリダイレクトされる | ログイン済みの状態 | 1. ブラウザで /register にアクセス | トップ画面（/）にリダイレクトされる | 高 |
| TC-029 | 新規登録画面 | 登録ボタンが二重送信を防止する | /register にアクセスしている | 1. 正しい情報を入力<br>2. 「新規登録」ボタンを素早く2回クリック | ボタンがローディング状態になり、2回目のクリックが無視される | 中 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-030 | 新規登録画面 | PC画面で正しくレイアウトされる | PCブラウザ（幅768px以上） | 1. /register にアクセス | 和風背景 + 白い枠のフォームが中央に表示される。ヘッダーは非表示 | 中 |
| TC-031 | 新規登録画面 | スマホ画面で正しくレイアウトされる | モバイルブラウザ（幅767px以下） | 1. /register にアクセス | フォームが画面幅に収まり、全入力欄とボタンがタップしやすいサイズで表示される | 中 |

---

## 3. パスワードリセット画面（/reset-password）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-032 | パスワードリセット画面 | 登録済みメールアドレスでリセットメールが送信される | 登録済みのメールアドレスが存在する | 1. /reset-password にアクセス<br>2. 登録済みメールアドレスを入力<br>3. 「リセットメールを送信」をクリック | 「パスワードリセット用のメールを送信しました。メールをご確認ください」が表示される | 高 |
| TC-033 | パスワードリセット画面 | リセットメールのリンクからパスワードを再設定できる | TC-032 でリセットメール送信済み | 1. リセットメール内のリンクをクリック<br>2. 新しいパスワード（8文字以上）を入力<br>3. 確認パスワードを入力<br>4. 送信する | 「パスワードを変更しました」が表示され、ログイン画面に遷移する | 高 |
| TC-034 | パスワードリセット画面 | 「ログインに戻る」リンクで遷移できる | /reset-password にアクセスしている | 1. 「ログインに戻る」リンクをクリック | /login に遷移する | 低 |

### 異常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-035 | パスワードリセット画面 | メールアドレス未入力時にエラーが表示される | /reset-password にアクセスしている | 1. メールアドレスを空のまま<br>2. 「リセットメールを送信」をクリック | 「メールアドレスを入力してください」が赤字で表示される | 高 |
| TC-036 | パスワードリセット画面 | 不正なメール形式でエラーが表示される | /reset-password にアクセスしている | 1. メールアドレス欄に「abc」と入力<br>2. 「リセットメールを送信」をクリック | 「正しいメールアドレスを入力してください」が赤字で表示される | 高 |
| TC-037 | パスワードリセット画面 | 未登録メールアドレスでも同じメッセージが表示される（セキュリティ） | /reset-password にアクセスしている | 1. 未登録のメールアドレスを入力<br>2. 「リセットメールを送信」をクリック | 「パスワードリセット用のメールを送信しました。メールをご確認ください」が表示される（登録済みと同じメッセージ） | 高 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-038 | パスワードリセット画面 | ログイン済みユーザーはトップにリダイレクトされる | ログイン済みの状態 | 1. ブラウザで /reset-password にアクセス | トップ画面（/）にリダイレクトされる | 中 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-039 | パスワードリセット画面 | スマホ画面で正しくレイアウトされる | モバイルブラウザ（幅767px以下） | 1. /reset-password にアクセス | フォームが画面幅に収まり、ボタンがタップしやすいサイズで表示される | 低 |

---

## 4. トップ画面（/）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-040 | トップ画面 | 日本地図が正しく表示される | ログイン済み。いくつかの都道府県で正解済み | 1. / にアクセス | SVG形式の日本地図が表示され、正解済みの都道府県に色がついている（初級:薄い緑、中級:緑、上級:深い緑、未回答:グレー） | 高 |
| TC-041 | トップ画面 | ジャンル→難易度→スタートのステップ選択ができる | ログイン済みで / にアクセスしている | 1. ジャンル「地理」をタップ<br>2. 難易度「初級」をタップ<br>3. 「ゲームスタート！」をタップ | 1. 地理がハイライトされ、難易度ボタン×3が出現<br>2. 初級がハイライトされ、「ゲームスタート！」ボタンが出現<br>3. クイズ画面（/quiz）に遷移する | 高 |
| TC-042 | トップ画面 | ジャンルを選び直すと難易度・スタートがリセットされる | ジャンルと難易度を選択済み | 1. 別のジャンルをタップ | 難易度選択と「ゲームスタート！」ボタンがリセットされ、新しいジャンルがハイライトされる | 中 |
| TC-043 | トップ画面 | 難易度を変更できる | ジャンルと難易度を選択済み | 1. 別の難易度をタップ | 選択した難易度がハイライトに切り替わる。「ゲームスタート！」ボタンは表示されたまま | 中 |
| TC-044 | トップ画面 | 日本地図タップで達成状況画面に遷移する | ログイン済みで / にアクセスしている | 1. 日本地図をタップ | 達成状況画面（/achievement）に遷移する | 中 |
| TC-045 | トップ画面 | 「回答履歴を見る」ボタンで履歴画面に遷移する | ログイン済みで / にアクセスしている | 1. 「回答履歴を見る」ボタンをタップ | 回答履歴画面（/history）に遷移する | 中 |

### 異常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-046 | トップ画面 | AI利用上限に達している場合にエラーが表示される | 当日すでに20回クイズをプレイ済み | 1. ジャンルと難易度を選択<br>2. 「ゲームスタート！」をタップ | 「本日の利用上限に達しました。明日またお楽しみください」が表示される | 高 |
| TC-047 | トップ画面 | ジャンル未選択でスタートボタンが表示されない | ログイン済みで / にアクセスしている | 1. 初期表示を確認 | ジャンル選択ボタン×3のみ表示され、難易度ボタンと「ゲームスタート！」は非表示 | 中 |
| TC-048 | トップ画面 | 難易度未選択でスタートボタンが表示されない | ジャンルのみ選択済み | 1. ジャンルをタップ<br>2. 難易度を選択しない | 難易度ボタン×3が表示されるが、「ゲームスタート！」ボタンは非表示 | 中 |

### 境界値

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-049 | トップ画面 | AI利用回数が19回（上限-1）の場合にゲームスタートできる | 当日19回クイズをプレイ済み | 1. ジャンルと難易度を選択<br>2. 「ゲームスタート！」をタップ | クイズ画面に正常に遷移する（20回目なので上限内） | 高 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-050 | トップ画面 | 未ログインユーザーはログイン画面にリダイレクトされる | 未ログイン状態 | 1. ブラウザで / にアクセス | ログイン画面（/login）にリダイレクトされる | 高 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-051 | トップ画面 | PC画面で地図とステップ選択が正しく表示される | PCブラウザ（幅768px以上）でログイン済み | 1. / にアクセス | 日本地図が見やすいサイズで表示され、ヘッダーにナビゲーションボタンが並ぶ | 中 |
| TC-052 | トップ画面 | スマホ画面で地図とステップ選択が正しく表示される | モバイルブラウザ（幅767px以下）でログイン済み | 1. / にアクセス | 日本地図が画面幅に収まり、ステップ選択ボタンがタップしやすいサイズで表示される。ヘッダーにハンバーガーメニューが表示される | 中 |

---

## 5. クイズ画面（/quiz）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-053 | クイズ画面 | クイズ生成中にローディングが表示される | トップ画面でジャンルと難易度を選択済み | 1. 「ゲームスタート！」をタップ | 「クイズを生成中です...」とローディングアニメーションが表示される | 高 |
| TC-054 | クイズ画面 | 5問のクイズが正しく表示される | クイズ生成が完了している | 1. ローディング完了を待つ | 1問目が表示される。進捗は「問題 1 / 5」。問題文と選択肢×3が表示される | 高 |
| TC-055 | クイズ画面 | 選択肢をタップするとハイライトされる | クイズが表示されている | 1. 選択肢Aをタップ<br>2. 選択肢Bをタップ | 1. 選択肢Aがハイライトされ「回答する」ボタンが活性化<br>2. 選択肢Bがハイライトされ、Aのハイライトが解除される | 高 |
| TC-056 | クイズ画面 | 正解時に正解表示と解説が表示される | 選択肢を選択済み | 1. 正解の選択肢を選択<br>2. 「回答する」をタップ | 「正解！」が表示される。正解の選択肢が緑でハイライトされ、解説文が表示される。選択肢ボタンが無効化される | 高 |
| TC-057 | クイズ画面 | 不正解時に不正解表示・正解・解説が表示される | 選択肢を選択済み | 1. 不正解の選択肢を選択<br>2. 「回答する」をタップ | 「不正解」が表示される。選んだ選択肢が赤、正解の選択肢が緑でハイライトされ、解説文が表示される。選択肢ボタンが無効化される | 高 |
| TC-058 | クイズ画面 | 「次の問題へ」で次の問題に進む | 1問目の回答・解説表示が完了している | 1. 「次の問題へ」をタップ | 2問目が表示される。進捗が「問題 2 / 5」に更新される | 高 |
| TC-059 | クイズ画面 | 5問目の回答後に「結果を見る」ボタンが表示される | 4問目まで回答済みで5問目の解説が表示されている | 1. 5問目に回答する | 「次の問題へ」ではなく「結果を見る」ボタンが表示される | 高 |
| TC-060 | クイズ画面 | 「結果を見る」で結果画面に遷移する | 5問目の回答が完了している | 1. 「結果を見る」をタップ | 結果画面（/result）に遷移する | 高 |

### 異常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-061 | クイズ画面 | AI生成が3回失敗した場合にエラーと再試行ボタンが表示される | AI APIが応答しない状態 | 1. クイズ画面に遷移する | ローディング表示後、3回リトライが行われ、最終的に「問題の生成に失敗しました。もう一度お試しください」と「再試行」ボタンが表示される | 高 |
| TC-062 | クイズ画面 | 再試行ボタンでクイズ生成を再実行できる | TC-061 のエラー表示状態。AI APIが復旧済み | 1. 「再試行」ボタンをタップ | ローディングが表示され、クイズ生成が再実行される | 高 |
| TC-063 | クイズ画面 | 選択肢未選択時に「回答する」ボタンが非活性 | クイズが表示されている | 1. 選択肢を選択しない状態を確認 | 「回答する」ボタンが非活性（クリック不可）の状態である | 中 |
| TC-064 | クイズ画面 | クイズ中にブラウザを閉じると途中データが破棄される | クイズ回答中（例:3問目まで回答済み） | 1. ブラウザを閉じる<br>2. 再度アプリにアクセスしてトップ画面に遷移 | トップ画面が表示される。途中のクイズデータは保存されていない | 中 |
| TC-065 | クイズ画面 | クイズ中にネットワークが切断されるとエラーが表示される | クイズ回答中 | 1. ネットワーク接続を切断<br>2. 回答操作を行う | エラー表示がされる。回答済みのデータは保存されない | 中 |

### 境界値

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-066 | クイズ画面 | 全47都道府県が正解済みの場合でもクイズが出題される | 全都道府県で選択した難易度の正解済み | 1. ジャンルと難易度を選択して「ゲームスタート！」をタップ | 全47県からランダムに5県が選ばれ、クイズが正常に生成・表示される | 高 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-067 | クイズ画面 | 未ログインユーザーはログイン画面にリダイレクトされる | 未ログイン状態 | 1. ブラウザで /quiz にアクセス | ログイン画面（/login）にリダイレクトされる | 高 |
| TC-068 | クイズ画面 | ジャンル・難易度未選択で直接アクセスするとトップにリダイレクトされる | ログイン済みだが、ジャンル・難易度を選択していない | 1. ブラウザで /quiz に直接アクセス | トップ画面（/）にリダイレクトされる | 高 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-069 | クイズ画面 | PC画面でクイズが正しく表示される | PCブラウザ（幅768px以上）でクイズ中 | 1. クイズ画面を確認 | 問題文・選択肢・ボタンが見やすく配置される | 中 |
| TC-070 | クイズ画面 | スマホ画面でクイズが正しく表示される | モバイルブラウザ（幅767px以下）でクイズ中 | 1. クイズ画面を確認 | 問題文が画面幅に収まり、選択肢ボタンがタップしやすいサイズで縦に並ぶ | 中 |

---

## 6. 結果画面（/result）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-071 | 結果画面 | 正解数が大きく表示される | 5問回答完了後に結果画面に遷移 | 1. 結果画面の表示を確認 | 「5問中 X問正解！」が大きく表示される | 高 |
| TC-072 | 結果画面 | 正解数に応じたメッセージが表示される | 5問回答完了後に結果画面に遷移 | 1. 5問正解の場合のメッセージを確認<br>2. 3〜4問正解の場合<br>3. 1〜2問正解の場合<br>4. 0問正解の場合 | 1. 「パーフェクト！日本マスターへの道を順調に進んでいます！」<br>2. 「いい調子です！もう少しで全問正解！」<br>3. 「次はもっと上を目指しましょう！」<br>4. 「ドンマイ！挑戦することが大事です！」 | 高 |
| TC-073 | 結果画面 | 全問一覧が正しく表示される | 5問回答完了後に結果画面に遷移 | 1. 全問一覧の表示を確認 | 5問すべてが順に表示される。正解は正解マーク、不正解は不正解マーク + 正解 + 解説が表示される | 高 |
| TC-074 | 結果画面 | 「同じ条件でもう一度」ボタンで同条件のクイズを開始できる | 結果画面が表示されている。AI利用上限に達していない | 1. 「同じ条件でもう一度」ボタンをタップ | 同じジャンル・難易度でクイズ画面に遷移し、新しいクイズが生成される | 高 |
| TC-075 | 結果画面 | 「トップに戻る」ボタンでトップ画面に遷移する | 結果画面が表示されている | 1. 「トップに戻る」ボタンをタップ | トップ画面（/）に遷移する | 中 |

### 異常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-076 | 結果画面 | 「同じ条件でもう一度」タップ時にAI利用上限に達している場合 | 当日の利用回数が20回に達している | 1. 「同じ条件でもう一度」ボタンをタップ | 「本日の利用上限に達しました。明日またお楽しみください」が表示される | 高 |

### 境界値

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-077 | 結果画面 | 0問正解時のメッセージが正しく表示される | 5問すべて不正解で結果画面に遷移 | 1. 結果画面の表示を確認 | 「5問中 0問正解！」と「ドンマイ！挑戦することが大事です！」が表示される | 中 |
| TC-078 | 結果画面 | 5問全問正解時のメッセージが正しく表示される | 5問すべて正解で結果画面に遷移 | 1. 結果画面の表示を確認 | 「5問中 5問正解！」と「パーフェクト！日本マスターへの道を順調に進んでいます！」が表示される | 中 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-079 | 結果画面 | 未ログインユーザーはログイン画面にリダイレクトされる | 未ログイン状態 | 1. ブラウザで /result にアクセス | ログイン画面（/login）にリダイレクトされる | 高 |
| TC-080 | 結果画面 | セッションIDなしで直接アクセスするとトップにリダイレクトされる | ログイン済みだが、クイズ未実施 | 1. ブラウザで /result に直接アクセス | トップ画面（/）にリダイレクトされる | 高 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-081 | 結果画面 | スマホ画面で結果一覧が正しく表示される | モバイルブラウザ（幅767px以下） | 1. 結果画面を確認 | 正解数・メッセージ・全問一覧・ボタンが画面幅に収まり、スクロールで閲覧できる | 中 |

---

## 7. 回答履歴画面（/history）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-082 | 回答履歴画面 | 過去のクイズ結果が新しい順に表示される | 複数のクイズセッションが存在する | 1. /history にアクセス | セッション一覧が新しい順に表示される。各セッションに日付・ジャンル・難易度・正解数が表示される | 高 |
| TC-083 | 回答履歴画面 | 折りたたみを展開すると全問題と解説が表示される | セッション一覧が表示されている | 1. セッションの展開ボタン（▼）をタップ | アコーディオンが展開され、そのセッションの全問題・回答・正解/不正解・解説が表示される | 高 |
| TC-084 | 回答履歴画面 | ページネーションで次のページに遷移できる | 11件以上のセッションが存在する | 1. ページネーションの「次のページ」または「2」をクリック | 2ページ目のセッション一覧（11〜20件目）が表示される | 中 |
| TC-085 | 回答履歴画面 | データがない場合にメッセージが表示される | まだクイズを一度もプレイしていない | 1. /history にアクセス | 「まだクイズを回答していません。トップページからクイズに挑戦してみましょう！」が表示される | 中 |

### 異常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-086 | 回答履歴画面 | データ取得中にスケルトン表示がされる | /history にアクセス中 | 1. 画面の初期表示を確認 | データ取得完了まで、スケルトン表示（グレーの枠が点滅）が表示される | 中 |

### 境界値

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-087 | 回答履歴画面 | ちょうど10件のセッションがある場合にページネーションが表示されない | セッション数がちょうど10件 | 1. /history にアクセス | 10件のセッションが表示され、ページネーションは表示されない（または非活性） | 低 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-088 | 回答履歴画面 | 未ログインユーザーはログイン画面にリダイレクトされる | 未ログイン状態 | 1. ブラウザで /history にアクセス | ログイン画面（/login）にリダイレクトされる | 高 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-089 | 回答履歴画面 | PC画面でセッション一覧が正しく表示される | PCブラウザ（幅768px以上） | 1. /history にアクセス | セッションカードが見やすいサイズで表示され、折りたたみの展開・閉じが正しく動作する | 中 |
| TC-090 | 回答履歴画面 | スマホ画面でセッション一覧が正しく表示される | モバイルブラウザ（幅767px以下） | 1. /history にアクセス | セッションカードが画面幅に収まり、タップで折りたたみを展開できる | 中 |

---

## 8. 達成状況画面（/achievement）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-091 | 達成状況画面 | 日本地図が色付きで正しく表示される | いくつかの都道府県で正解済み | 1. /achievement にアクセス | 日本地図が表示され、正解済みの都道府県が難易度に応じた色で塗られている | 高 |
| TC-092 | 達成状況画面 | 制覇状況が正しく表示される | いくつかの都道府県で正解済み | 1. /achievement にアクセス | 「47都道府県中 X個クリア」と進捗バーが正しく表示される | 高 |
| TC-093 | 達成状況画面 | 難易度別の制覇数が正しく表示される | 各難易度でいくつかの都道府県を正解済み | 1. /achievement にアクセス | 「初級: X/47、中級: Y/47、上級: Z/47」が正しく表示される | 高 |
| TC-094 | 達成状況画面 | 総回答数と全体正答率が正しく表示される | 複数回クイズをプレイ済み | 1. /achievement にアクセス | 総回答数（全問題数合計）と全体正答率（正解数 / 総回答数 * 100）が正しく表示される | 中 |
| TC-095 | 達成状況画面 | ジャンル別正答率が正しく表示される | 各ジャンルでクイズをプレイ済み | 1. /achievement にアクセス | 「地理: X%、観光名所: Y%、グルメ: Z%」がそれぞれ正しく表示される | 中 |

### 境界値

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-096 | 達成状況画面 | データがない場合のデフォルト表示 | まだクイズを一度もプレイしていない | 1. /achievement にアクセス | 制覇状況は「0 / 47」で進捗バー 0%。正答率は「まだ回答がありません」。地図は全都道府県がグレー | 中 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-097 | 達成状況画面 | 未ログインユーザーはログイン画面にリダイレクトされる | 未ログイン状態 | 1. ブラウザで /achievement にアクセス | ログイン画面（/login）にリダイレクトされる | 高 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-098 | 達成状況画面 | PC画面で達成状況が正しく表示される | PCブラウザ（幅768px以上） | 1. /achievement にアクセス | 日本地図と各統計情報が見やすいレイアウトで表示される | 中 |
| TC-099 | 達成状況画面 | スマホ画面で達成状況が正しく表示される | モバイルブラウザ（幅767px以下） | 1. /achievement にアクセス | 日本地図が画面幅に収まり、統計情報が縦に並んでスクロール閲覧できる | 中 |

---

## 9. 設定画面（/settings）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-100 | 設定画面 | パスワードを変更できる | ログイン済みでメール&パスワード認証のアカウント | 1. /settings にアクセス<br>2. 現在のパスワードを入力<br>3. 新しいパスワード（8文字以上）を入力<br>4. 新しいパスワード（確認）を入力<br>5. 「パスワードを変更」ボタンをクリック | 「パスワードを変更しました」が表示される | 高 |
| TC-101 | 設定画面 | 変更後の新しいパスワードでログインできる | TC-100 でパスワード変更済み | 1. ログアウトする<br>2. 新しいパスワードでログインする | 正常にログインできる | 高 |
| TC-102 | 設定画面 | アカウントを削除できる | ログイン済み | 1. /settings にアクセス<br>2. 「アカウントを削除」ボタンをクリック<br>3. 確認ダイアログで「削除する」をクリック | アカウントが削除され、ログイン画面にリダイレクトされる | 高 |
| TC-103 | 設定画面 | アカウント削除の確認ダイアログでキャンセルできる | ログイン済みで /settings にアクセスしている | 1. 「アカウントを削除」ボタンをクリック<br>2. 確認ダイアログで「キャンセル」をクリック | ダイアログが閉じ、何も実行されない。設定画面のまま | 中 |

### 異常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-104 | 設定画面 | 現在のパスワード未入力時にエラーが表示される | /settings にアクセスしている | 1. 現在のパスワードを空のまま<br>2. 新しいパスワードを入力<br>3. 「パスワードを変更」ボタンをクリック | 「現在のパスワードを入力してください」が赤字で表示される | 高 |
| TC-105 | 設定画面 | 新しいパスワード未入力時にエラーが表示される | /settings にアクセスしている | 1. 現在のパスワードを入力<br>2. 新しいパスワードを空のまま<br>3. 「パスワードを変更」ボタンをクリック | 「新しいパスワードを入力してください」が赤字で表示される | 高 |
| TC-106 | 設定画面 | 新しいパスワードが8文字未満でエラーが表示される | /settings にアクセスしている | 1. 現在のパスワードを入力<br>2. 新しいパスワードに「abc1234」（7文字）を入力<br>3. 「パスワードを変更」ボタンをクリック | 「パスワードは8文字以上で入力してください」が赤字で表示される | 高 |
| TC-107 | 設定画面 | 新しいパスワードと確認が不一致でエラーが表示される | /settings にアクセスしている | 1. 現在のパスワードを入力<br>2. 新しいパスワードに「newpass01」を入力<br>3. 確認に「newpass02」を入力<br>4. 「パスワードを変更」ボタンをクリック | 「パスワードが一致しません」が赤字で表示される | 高 |
| TC-108 | 設定画面 | アカウント削除後に関連データも削除されている | TC-102 でアカウント削除済み | 1. 管理者がデータベースを確認（users, quiz_sessions, quizzes, answers, prefecture_progress） | 削除したユーザーに紐づくすべてのデータが存在しない（CASCADE削除） | 高 |

### 境界値

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-109 | 設定画面 | 新しいパスワード8文字ちょうどで変更できる | /settings にアクセスしている | 1. 現在のパスワードを入力<br>2. 新しいパスワードに「abcd1234」（8文字）を入力<br>3. 確認にも同じ値を入力<br>4. 「パスワードを変更」ボタンをクリック | パスワードバリデーションを通過し、変更処理が実行される | 高 |
| TC-110 | 設定画面 | 新しいパスワード7文字で変更できない | /settings にアクセスしている | 1. 現在のパスワードを入力<br>2. 新しいパスワードに「abcd123」（7文字）を入力<br>3. 確認にも同じ値を入力<br>4. 「パスワードを変更」ボタンをクリック | 「パスワードは8文字以上で入力してください」が赤字で表示される | 高 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-111 | 設定画面 | 未ログインユーザーはログイン画面にリダイレクトされる | 未ログイン状態 | 1. ブラウザで /settings にアクセス | ログイン画面（/login）にリダイレクトされる | 高 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-112 | 設定画面 | スマホ画面で設定画面が正しく表示される | モバイルブラウザ（幅767px以下） | 1. /settings にアクセス | パスワード変更フォームとアカウント削除ボタンが画面幅に収まり、操作しやすいサイズで表示される | 中 |

---

## 10. 共通機能（ヘッダー・ナビゲーション・ログアウト）

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-113 | 共通機能 | PC版ヘッダーのナビゲーションリンクが正しく動作する | PCブラウザ（幅768px以上）でログイン済み | 1. ヘッダーの「回答履歴」をクリック<br>2. ヘッダーの「達成状況」をクリック<br>3. ヘッダーの「設定」をクリック | 1. /history に遷移<br>2. /achievement に遷移<br>3. /settings に遷移 | 高 |
| TC-114 | 共通機能 | ヘッダーのロゴクリックでトップ画面に遷移する | ログイン済みで認証必要ページにいる | 1. ヘッダーの「JapanMaster」ロゴをクリック | トップ画面（/）に遷移する | 中 |
| TC-115 | 共通機能 | ログアウトが正しく動作する | ログイン済み | 1. 「ログアウト」をクリック<br>2. 確認ダイアログで「はい」をクリック | ログアウトされ、ログイン画面（/login）にリダイレクトされる | 高 |
| TC-116 | 共通機能 | ログアウト確認ダイアログで「いいえ」を選択するとキャンセルされる | ログイン済み | 1. 「ログアウト」をクリック<br>2. 確認ダイアログで「いいえ」をクリック | ダイアログが閉じ、現在の画面にとどまる | 中 |
| TC-117 | 共通機能 | 認証不要ページ（login, register, reset-password）ではヘッダーが非表示 | 未ログイン状態 | 1. /login にアクセス<br>2. /register にアクセス<br>3. /reset-password にアクセス | いずれの画面でもヘッダー（ナビゲーション）が表示されない | 中 |
| TC-118 | 共通機能 | 認証必要ページではヘッダーが表示される | ログイン済み | 1. / にアクセス<br>2. /history にアクセス<br>3. /achievement にアクセス<br>4. /settings にアクセス | いずれの画面でもヘッダー（ナビゲーション）が表示される | 中 |

### 認証ガード

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-119 | 共通機能 | セッション有効期限（7日）が切れると再ログインが要求される | ログインから7日以上経過した状態 | 1. 任意の認証必要ページにアクセス | ログイン画面にリダイレクトされ、再ログインが必要 | 高 |

### レスポンシブ

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-120 | 共通機能 | PC版（768px以上）でヘッダーにナビボタンが並ぶ | PCブラウザ（幅768px以上）でログイン済み | 1. ヘッダーの表示を確認 | 「JapanMaster」ロゴの右側に「回答履歴」「達成状況」「設定」「ログアウト」ボタンが横並びで表示される | 高 |
| TC-121 | 共通機能 | スマホ版（767px以下）でハンバーガーメニューが表示される | モバイルブラウザ（幅767px以下）でログイン済み | 1. ヘッダーの表示を確認<br>2. ハンバーガーメニュー（≡）をタップ | 1. ヘッダーに「JapanMaster」と≡アイコンが表示される<br>2. メニューが開き「回答履歴」「達成状況」「設定」「ログアウト」が表示される | 高 |
| TC-122 | 共通機能 | レスポンシブ切り替えが正しく動作する | ブラウザのウィンドウサイズを変更できる環境 | 1. ブラウザ幅を768pxから767pxに変更<br>2. 768pxに戻す | 1. ヘッダーのナビボタンが消え、ハンバーガーメニューに切り替わる<br>2. ハンバーガーメニューが消え、ナビボタンが横並びに戻る | 中 |

---

## 11. エラー画面・ローディング

### 正常系

| テストID | カテゴリ | テスト項目 | 前提条件 | 操作手順 | 期待結果 | 優先度 |
|----------|----------|------------|----------|----------|----------|--------|
| TC-123 | エラー画面 | 404ページが正しく表示される | なし | 1. 存在しないURL（例: /nonexistent）にアクセス | 「ページが見つかりません」と「トップに戻る」ボタンが表示される | 中 |
| TC-124 | エラー画面 | 404ページの「トップに戻る」ボタンが動作する | TC-123 の状態 | 1. 「トップに戻る」ボタンをクリック | トップ画面（/）に遷移する | 中 |
| TC-125 | エラー画面 | 500エラーページが正しく表示される | サーバーエラーが発生する状態 | 1. サーバーエラーが発生するページにアクセス | 「サーバーでエラーが発生しました。時間をおいて再度お試しください」と「トップに戻る」ボタンが表示される | 中 |
| TC-126 | エラー画面 | ネットワークエラーが正しく表示される | ネットワーク未接続の状態 | 1. ネットワーク接続を切断した状態でページにアクセス | 「通信に失敗しました。ネットワーク接続を確認してください」と「再読み込み」ボタンが表示される | 中 |
| TC-127 | ローディング | 各場面でローディング表示が適切に表示される | ログイン済み | 1. クイズ生成中の表示を確認<br>2. ページ遷移中の表示を確認<br>3. 履歴・達成状況画面のデータ取得中の表示を確認 | 1. 「クイズを生成中です...」+ スピナー<br>2. 画面上部にプログレスバー<br>3. スケルトン表示（グレーの枠が点滅） | 中 |

---

## 補足事項

### 対応ブラウザ

以下のブラウザで主要テストケース（優先度「高」）を確認すること。

| ブラウザ | バージョン |
|----------|------------|
| Google Chrome | 最新安定版 |
| Safari | 最新安定版 |
| Firefox | 最新安定版 |
| Microsoft Edge | 最新安定版 |

### テスト実施時の注意事項

1. **認証ガードテスト**: シークレットウィンドウ（プライベートブラウジング）を使用して未ログイン状態を再現すること
2. **レスポンシブテスト**: Chrome DevTools のデバイスエミュレーション機能を活用すること
3. **境界値テスト**: 文字数カウントは正確に行い、8文字ちょうど（OK）と7文字（NG）の両方を必ず確認すること
4. **AI利用上限テスト**: テスト環境では上限値を一時的に引き下げて効率的にテストすること
5. **エラー系テスト**: ネットワーク切断のテストは Chrome DevTools の「Offline」モードを活用すること
6. **広告スペース**: フェーズ1では広告の実装はしないため、広告スペースの枠（高さ50px〜90px）が確保されていることのみ確認する
7. **データ整合性**: アカウント削除テスト後は、データベースのCASCADE削除が正しく機能しているかを直接確認すること
